<app-header [defaultHref]="'/private/tabs/transports/new-delivery/vehicle-choice'"></app-header>

<ion-content>
  <app-progress-bar [current]="0.20" [next]="0.40" ></app-progress-bar>
  <ion-grid class="page-grid">
    <ion-row>
      <ion-col>
        <h2>Enlèvement</h2>
      </ion-col>
    </ion-row>

    <ion-row *ngIf="!isLoading && address.length <= 0">
      <ion-col>
        <p class="ion-text-center">
          Pas encore d'adresses dans votre carnet!<br />
          Merci d'en ajouter une!
        </p>
      </ion-col>
    </ion-row>

    <ion-row *ngIf="!isLoading && address.length > 0">
      <ion-col>


        <form [formGroup]="form">
          <ion-accordion-group>
            <ion-accordion  [value]="address.pk" *ngFor="let address of address">
              <ion-item slot="header" class="ion-align-items-start">
                <ion-label>
                  <h3>{{address.name}}</h3>
                  <p>{{address.address}} {{address.postcode}} {{address.city}} {{getCountry(address.country)}}</p>
                </ion-label>
              </ion-item>
              <div class="content ion-no-padding" slot="content">
                <ion-row>
                  <ion-col>
                    <ion-item class="ion-no-padding">
                      <ion-label position="floating" class="custom-size">Date d'enlèvement</ion-label>
                      <ion-input type="text" formControlName="date" (click)="openDatePicker('date')" [disabled]="selectedAccordionPk !== address.pk"></ion-input>
                    </ion-item>
                  </ion-col>
                  <ion-col>
                    <ion-item class="ion-no-padding">
                      <ion-label position="floating" class="custom-size">Heure d'enlèvement</ion-label>
                      <ion-input type="text" formControlName="hour" [disabled]="selectedAccordionPk !== address.pk"></ion-input>
                    </ion-item>
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col>
                    <ion-item class="ion-no-padding">
                      <ion-label position="floating" class="custom-size">Instructions pour l'enlèvement</ion-label>
                      <ion-textarea formControlName="instruction" [disabled]="selectedAccordionPk !== address.pk"></ion-textarea>
                    </ion-item>
                  </ion-col>
                </ion-row>
                <ion-row>
                  <ion-col class="ion-padding">
                    <ion-buttons class="ion-justify-content-end">
                      <ion-button type="button" [disabled]="!form.valid" color="primary"  fill="outline" shape="round" (click)="onSelectedAddress(address.pk)">
                        <span class="custom-btn">
                          <ion-text class="ion-margin-bottom">Choisir cette adresse</ion-text>
                        </span>
                      </ion-button>
                    </ion-buttons>
                  </ion-col>
                </ion-row>
              </div>
            </ion-accordion>
          </ion-accordion-group>
        </form>

      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
